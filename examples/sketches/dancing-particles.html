<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>2011-08-18 A</title>
<link rel="stylesheet" href="/stylesheets/style.css">
<script src="sketch.js"></script>
<script src="/javascripts/images.js"></script>
</head>
<body>
<canvas></canvas>
<script type="text/javascript">
Sketch.create(function(){
	
	var PARTICLE_COUNT = 400,
		particles = [],
		vel_min = -10, 
		vel_max = 10;
	
	var Particle = function (location, canvasInstance) {
		// this.location = location || new Point(0, 0);
		this.location = location == undefined ? new Point(0, 0) : location;
		this.velocity = new Point();
		this.radius = 1;
		this.color = {r:100,g:30,b:50};
	};
	
	Particle.prototype = {
		update: function () {
			this.velocity.limit(10);
			
			var acc = new Point(
				Math.cos($c.frame/100) * Math.random() < 0.5 ? -1 : 1,
				Math.sin($c.frame/100) * Math.random() < 0.5 ? -1 : 1
			);
			
			this.velocity.add(acc);
			this.location.add(this.velocity);

			this.radius = map(Math.abs(this.velocity.x), 0, 1, 0.1, 1);
		},
		draw: function () {

			// var r = Math.round(Math.random() * 255), 
			// 	g = Math.round(Math.random() * 255), 
			// 	b = Math.round(Math.random() * 255);

			// var r = map(this.radius, 0.1, 5, 0, 255),
			// 	g = map(this.radius, 0.1, 5, 0, 255),
			// 	b = map(this.radius, 0.1, 5, 0, 255);

			var cos_color = Math.round(map(Math.cos($c.frame/1000), -1.0, 1.0, 0, 255)),
			sin_color = Math.round(map(Math.sin($c.frame/1000), -1.0, 1.0, 0, 255));
			
			var r = cos_color,
				g = sin_color,
				b = cos_color;
			
			// var r = this.color.r,
			// 	g = this.color.g,
			// 	b = this.color.b;
			// 	
			// r = r > 255 ? 0 : r;
			// g = g > 255 ? 0 : g;
			// b = b > 255 ? 0 : b;
			// 
			// r++;
			// g++;
			// b++;
			
			var color = 'rgba(' + r + ',' + g + ',' + b + ', 1)';
			
			// $c.context.fillStyle = color;
			// $c.context.beginPath();
			// $c.context.arc(this.location.x, this.location.y, this.radius, 0, Math.PI*2, true); 
			// $c.context.closePath();
			// $c.context.fill();
			
			fill(color);
			circle(this.location, this.radius);
			
		},
		bounds: function () {
			var l = this.location,
				s = this.radius;
			
			if (l.x > $c.WIDTH + s) {
				l.x =  -s;
			} else if (l.x < -s) {
				l.x = $c.WIDTH + s;
			};
			if (l.y > $c.HEIGHT + s) {
				l.y = -s;
			} else if (l.y < -s) {
				l.y = $c.HEIGHT + s;
			};

		},
		run: function () {
			this.bounds();
			this.update();
			this.draw();
		}
	};
	
	
	function setup () {
		stroke(false);
		
		for (var i=0; i < PARTICLE_COUNT; i++) {
			var loc = new Point(
				Math.random() * $c.WIDTH, 
				Math.random() * $c.HEIGHT
			);
			var p = new Particle(loc);
			particles.push(p);
		};
		
		$c.clear_screen = false;
	};
	
	function draw () {
		
		background('rgba(255,255,255,0.08)');
		
		for (var i=0; i < particles.length; i++) {
			var p = particles[i];
			p.run();
		};
	};
	
	Sketch.run(setup, draw);
	
});

</script>
</body>
</html>
